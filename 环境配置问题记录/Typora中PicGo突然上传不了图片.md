# Typora中PicGo+SM.MS图床突然上传图片失败解决

---

在 Typora 中写文档写的好好的，复制个图片想自动上传，结果一直上传失败。

我用的是PicGo+SM.MS图床的方式。

1. 排查PicGo。将图片拖到picgo上传区，发现上传不了，重启PicGo，没用。检查Server设置，然后重启，也依然不行。
2. 排查Sm.Ms。怀疑是不是 sm.ms的服务有问题，打开sm.ms的官网，将图片上传，发现sm.ms能上传图片。
3. 于是断定是picgo出了问题。特意又检查更新了picgo，依然没用。
4. 开始网上搜索问题，最后发现有人说是可以采用一个`sm.ms-user`插件解决，如下图。

![image-20240822220520887](https://s2.loli.net/2024/08/22/vhsMnzHC5P1OpQb.png)

问题来了，上传 smms-user这个插件，要先安装node.js！

于是可以按照网上的教程安装 node.js，安装完成后可以通过如下命令检查

```go
node -v
npm -v
```

这里npm是下载node.js就会自带的，负责管理安装包。

我这里犯了一个很煞笔的错误，我在验证的时候一直用`nmp -v`，然后一直显示没有这个命令，我竟然没有怀疑自己打错了！！！反而去网上各种搜教程，各种排查问题，发现都没用，还在感慨人家怎么装的都没有问题，搞了一个小时！！！最后发现是自己打错了的时候狠狠抽了自己一巴掌！

安装好 node.js后就可以下载插件了。然后将smms的API Token赋值进去就行了。

![image-20240822221141527](https://s2.loli.net/2024/08/22/tpNSmVAEDO4hxFB.png)

但是，这里又出现了一个新的问题！如果我用的是截图，发现Typora加载不了图片，也上传不了！

![image-20240822221416097](https://s2.loli.net/2024/08/22/GQHREZz2vlpctmC.png)

最后排查应该是图片的加载路径问题，要把typora里面图像设置的下面这个取消勾选（不小心点上了）

![image-20240822221638860](https://s2.loli.net/2024/08/22/nHS9L8yD1OvufEg.png)

OK！终于大功告成！